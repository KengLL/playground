<!doctype html>
<!-- MultiRepast4py Simulation Playground
     Based on TensorFlow Playground (Apache License 2.0)
     Original: Daniel Smilkov and Shan Carter -->
<html>
<head lang="en">
  <link rel="icon" type="image/png" href="favicon.png">
  <meta charset="utf-8">
  <meta name="viewport" content="width=1024">
  <meta name="keywords" content="multilayer networks,agent-based simulation,repast,spread dynamics">

  <meta property="og:type" content="article"/>
  <meta property="og:title" content="MultiRepast4py — Multilayer Simulation Playground"/>
  <meta property="og:description" content="Explore multilayer network spread simulations right in your browser.">

  <title>Multilayer Simulation Playground</title>
  <link rel="stylesheet" href="bundle.css" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500|Material+Icons" rel="stylesheet" type="text/css">
  <script src="lib.js"></script>
</head>
<body>

  <!-- Header -->
  <!-- <header>
    <h1 class="l--page">Tinker With a <b>Multilayer Simulation</b> <span class="optional">Right Here </span>in Your Browser.<br>Explore how information spreads across layered networks.</h1>
  </header> -->

  <!-- Top Controls -->
  <div id="top-controls">
    <div class="container l--page">
      <div class="timeline-controls">
        <button class="mdl-button mdl-js-button mdl-button--icon ui-resetButton" id="reset-button" title="Reset the simulation">
          <i class="material-icons">replay</i>
        </button>
        <button class="mdl-button mdl-js-button mdl-button--fab mdl-button--colored ui-playButton" id="play-pause-button" title="Run/Pause">
          <i class="material-icons">play_arrow</i>
          <i class="material-icons">pause</i>
        </button>
        <button class="mdl-button mdl-js-button mdl-button--icon ui-stepButton" id="next-step-button" title="Step">
          <i class="material-icons">skip_next</i>
        </button>
      </div>
      <div class="control">
        <span class="label">Steps</span>
        <span class="value" id="iter-number"></span>
      </div>
      <div class="control ui-numAgents">
        <label for="numAgents">Agents</label>
        <div class="select">
          <select id="numAgents">
            <option value="5">5</option>
            <option value="10">10</option>
            <option value="15">15</option>
            <option value="20" selected>20</option>
            <option value="30">30</option>
          </select>
        </div>
      </div>
      <div class="control ui-spreadRate">
        <label for="spreadRate">Spread Rate:&nbsp;<span class="value">0.10</span></label>
        <p class="slider">
          <input class="mdl-slider mdl-js-slider" type="range" id="spreadRate" min="0.01" max="1" step="0.01" value="0.3">
        </p>
      </div>
      <div class="control ui-recoveryRate">
        <label for="recoveryRate">Recovery Rate:&nbsp;<span class="value">0.05</span></label>
        <p class="slider">
          <input class="mdl-slider mdl-js-slider" type="range" id="recoveryRate" min="0" max="1" step="0.01" value="0.05">
        </p>
      </div>
      <div class="control ui-stepSpeed">
        <label for="stepSpeed">Step delay:&nbsp;<span class="value">200ms</span></label>
        <p class="slider">
          <input class="mdl-slider mdl-js-slider" type="range" id="stepSpeed" min="50" max="2000" step="50" value="200">
        </p>
      </div>
    </div>
  </div>

  <!-- Main Part -->
  <div id="main-part" class="l--page">

    <!-- Network Column (was Data) -->
    <div class="column data">
      <h4>
        <span>Network</span>
      </h4>
      <div class="ui-topology">
        <p>Choose network topology:</p>
        <div class="dataset-list">
          <div class="dataset" title="Random (Erdős–Rényi)">
            <canvas class="data-thumbnail" data-topology="random"></canvas>
            <div class="topology-label">Random</div>
          </div>
          <div class="dataset" title="Small-world (Watts–Strogatz)">
            <canvas class="data-thumbnail" data-topology="smallworld"></canvas>
            <div class="topology-label">Small-world</div>
          </div>
          <div class="dataset" title="Scale-free (Barabási–Albert)">
            <canvas class="data-thumbnail" data-topology="scalefree"></canvas>
            <div class="topology-label">Scale-free</div>
          </div>
        </div>
      </div>
      <div>
        <div class="ui-initialInfected">
          <label for="initialInfected">Initial infected:&nbsp;&nbsp;<span class="value">3</span></label>
          <p class="slider">
            <input class="mdl-slider mdl-js-slider" type="range" id="initialInfected" min="1" max="10" step="1" value="3">
          </p>
        </div>
        <button class="basic-button" id="data-regen-button" title="Regenerate network">
          Regenerate
        </button>
      </div>
    </div>

    <!-- Simulation Column (was Features) -->
    <div class="column features">
      <h4>
        <span class="simulation-title">Simulation</span>
        <div class="layers-header-controls">
          <button id="add-layers" class="mdl-button mdl-js-button mdl-button--icon" title="Add layer">
            <i class="material-icons">add</i>
          </button>
          <button id="remove-layers" class="mdl-button mdl-js-button mdl-button--icon" title="Remove layer">
            <i class="material-icons">remove</i>
          </button>
          <span id="num-layers"></span>
          <span id="layers-label"></span>
        </div>
      </h4>
      <div class="bracket"></div>
      <div id="network">
        <svg id="svg" width="510" height="450">
          <defs>
            <marker id="markerArrow" markerWidth="7" markerHeight="13" refX="1" refY="6" orient="auto" markerUnits="userSpaceOnUse">
              <path d="M2,11 L7,6 L2,2" />
            </marker>
          </defs>
        </svg>
        <!-- Hover card for agents and arcs -->
        <div id="hovercard">
          <div class="hovercard-content"></div>
        </div>
      </div>
      <!-- Per-layer controls appear here (below the SVG) -->
      <div id="layer-controls"></div>
    </div>

    <!-- Output Column -->
    <div class="column output">
      <h4>Output</h4>
      <div class="metrics">
        <div class="output-stats ui-infected">
          <span>Infected</span>
          <div class="value" id="loss-train"></div>
        </div>
        <div class="output-stats train">
          <span>Recovered</span>
          <div class="value" id="loss-test"></div>
        </div>
        <div id="linechart"></div>
      </div>

      <!-- Spread status bar -->
      <div id="stats-bars"></div>

      <div style="float:left;margin-top:10px">
        <!-- Agent state legend -->
        <div style="display:flex; align-items:center; gap:12px; flex-wrap:wrap;">
          <div class="agent-legend-item">
            <span class="agent-dot" style="background:#aaaaaa"></span>
            <span class="label">Susceptible</span>
          </div>
          <div class="agent-legend-item">
            <span class="agent-dot" style="background:#e74c3c"></span>
            <span class="label">Infected</span>
          </div>
          <div class="agent-legend-item">
            <span class="agent-dot" style="background:#2ecc71"></span>
            <span class="label">Recovered</span>
          </div>
        </div>
        <br/>
        <div class="label" style="font-size:11px; color:#666; margin-top:4px;">
          Arc color = layer &nbsp;|&nbsp; Arc opacity = connection weight
        </div>
      </div>

      <!-- Layer Nodes chart -->
      <div id="layer-chart-section">
        <div class="layer-chart-label">Infections per layer</div>
        <svg id="layer-chart-svg" height="80"></svg>
        <div class="layer-chart-label" style="margin-top:8px">Spread per agent</div>
        <svg id="agent-chart-svg" height="80"></svg>
      </div>

      <!-- Agent spread over time line chart -->
      <div id="agent-spread-section">
        <div class="layer-chart-label" id="agent-spread-label">Click an agent or bar to view spread history</div>
        <div id="agent-layer-section">
          <div class="layer-chart-label">Connections per layer</div>
          <svg id="agent-layer-svg" height="80"></svg>
        </div>
        <svg id="agent-spread-svg" height="100"></svg>
        <div id="agent-spread-legend"></div>
      </div>
    </div>

  </div>

  <!-- More -->
  <div class="more">
    <button class="mdl-button mdl-js-button mdl-button--fab">
      <i class="material-icons">keyboard_arrow_down</i>
    </button>
  </div>
  <!-- Article -->
  <article id="article-text">

    <div class="l--body">
      <h2>What Is a Multilayer Network?</h2>
      <p>A multilayer network models entities connected through different types of relationships, where each relationship type forms its own <strong>layer</strong>.</p>
      <p>Importantly, layers do <strong>not</strong> need to contain the exact same set of nodes. Different layers may involve different participants — for example, a workplace layer may include only employees, while a family layer includes relatives.</p>
      <p>In this playground, we transform the system by taking the <strong>union of all agents across layers</strong>. If an agent does not participate in a particular layer, it simply has no connections in that layer. This allows us to simulate efficiently without storing large multilayer matrices.</p>
      <p>This playground lets you observe how information (or disease) spreads across layers using a MultiRepast4py-inspired agent-based modeling approach, implemented in JavaScript for interactive exploration.</p>
    </div>

    <div class="l--body">
      <h2>Reading the Visualization</h2>
      <p>Each <strong>circle</strong> represents an agent. Agents are colored by their state: gray (Susceptible), red (Infected), or green (Recovered).</p>
      <p>Each <strong>layer</strong> of connections is drawn as a set of arcs. The first layer appears above the agents (orange), the second below (blue), and additional layers alternate position and color.</p>
      <p><strong>Arc thickness</strong> represents connection weight — thicker arcs correspond to stronger interactions and higher transmission probability.</p>
      <p>Hover over an agent to see which layer first infected it and how many agents it has infected per layer. Hover over an arc to see its weight.</p>
    </div>

    <div class="l--body">
      <h2>Controls</h2>
      <p><strong>Agents</strong>: number of agents in the simulation.</p>
      <p><strong>Spread Rate</strong>: base probability that an infected agent transmits in one step (scaled by edge weight).</p>
      <p><strong>Recovery Rate</strong>: probability an infected agent recovers per step.</p>
      <p><strong>Connectivity</strong> (per layer): edge density — higher values mean more connections in that layer.</p>
      <p><strong>Frequency</strong> (per layer): how often that layer activates (every N simulation steps). Not all interactions happen equally often — you likely see coworkers more frequently than extended family.</p>
    </div>

    <div class="l--body">
      <h2>Repurpose This?</h2>
      <p>This playground is open-source. It builds on the <a href="https://github.com/tensorflow/playground">TensorFlow Playground</a> (Apache 2.0) and demonstrates ideas from the <a href="https://github.com/Repast/repast4py">MultiRepast4py</a> multilayer simulation framework.</p>
    </div>

  </article>

  <!-- Footer -->
  <footer>
    <div class="l--body">
      <div class="links">
        <a href="https://github.com/tensorflow/playground">Based on TensorFlow Playground</a>
        &nbsp;|&nbsp;
        <a href="https://github.com/Repast/repast4py">MultiRepast4py</a>
      </div>
    </div>
  </footer>


  <script src="bundle.js"></script>
  <script src="analytics.js"></script>
</body>
</html>
